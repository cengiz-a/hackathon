<!DOCTYPE html>
<html>
<head>
	<title>Hackarthon 2016</title>
	<script src="./js/phaser.min.js"></script>
</head>
<body>
<script>
var game = new Phaser.Game(1280, 960, Phaser.AUTO, '', { preload: preload, create: create, update: update });

var cursor;
var tiledElephant;
var tiledCity;

var count = 0;
var life = 100;

var lifeDecreaseTimer;

var lifeText;
var style = { font: "bold 32px Arial", fill: "#fff", boundsAlignH: "center", boundsAlignV: "middle" };

var rectStage1 = new Phaser.Rectangle(-640, 0, 20, 20);
var rectStage2 = new Phaser.Rectangle(-1694, 0, 20, 20);
var rectStage3 = new Phaser.Rectangle(-2070, 0, 20, 20);
var rectStage4 = new Phaser.Rectangle(-2982, 0, 20, 20);

function updateBackground() {
	if(cursor.left.isDown) {
		// Move left
		tiledCity.tilePosition.x += 8;
	} else if(cursor.right.isDown) {
		// Move right
		tiledCity.tilePosition.x -= 8;
	}

	if(rectStage1.contains(tiledCity.tilePosition.x, tiledCity.tilePosition.y)) {
		console.log("level1");

		

	} else if(rectStage2.contains(tiledCity.tilePosition.x, tiledCity.tilePosition.y)) {
		console.log("level2");



	} else if(rectStage3.contains(tiledCity.tilePosition.x, tiledCity.tilePosition.y)) {
		console.log("level3");



	} else if(rectStage4.contains(tiledCity.tilePosition.x, tiledCity.tilePosition.y)) {
		console.log("level4");


	}
}

function updateElephant() {
	if(cursor.left.isDown) {
		// Move left
		count += 10;
		if(count >= 100) {
			tiledElephant.tilePosition.x -= 251;
			count = 0;
		}
	} else if(cursor.right.isDown) {
		// Move right
		count += 10;
		if(count >= 100) {
			tiledElephant.tilePosition.x += 251;	
			count = 0;
		}
	}

	if(cursor.space.isDown) {
		console.log(new Phaser.Rectangle(tiledCity.tilePosition.x, tiledCity.tilePosition.y));
	}
}

function preload() {
	// Load tiled elephant file
	game.load.image('elephant', 'assets/sprites/elephant.png');
	game.load.image('background', 'assets/sprites/city.png');
}

function create() {
	// cursor
	cursor = game.input.keyboard.addKeys({ 
		'up': Phaser.KeyCode.UP, 
		'down': Phaser.KeyCode.DOWN, 
		'left': Phaser.KeyCode.LEFT, 
		'right': Phaser.KeyCode.RIGHT, 
		'space': Phaser.KeyCode.SPACEBAR });

	// Make it tiled
	tiledCity = game.add.tileSprite(0, 0, 1280, 960, 'background');
	tiledElephant = game.add.tileSprite(300, 500, 250, 210, 'elephant');

	// Make a loop to update elif's life
	game.time.events.loop(Phaser.Timer.SECOND, updateLife, this);

	lifeText = game.add.text(1280 / 2, 10, "Life: " + life, style);
}

function updateLife() {
	life-=10;
	lifeText.setText("Life: " + life);
	if(life <= 0) {
		// Elif ist tod :(
		lifeText.setText("You died, biatch");
	}
}

function update() {
	updateElephant();
	updateBackground();
	
}

function render() {

}

</script>
</body>
</html>